<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="generator" content="pandoc" />
  <title></title>
</head>
<body>
<h1 id="suspending-and-hibernating-on-linux">Suspending and Hibernating on Linux</h1>
<p>A simple walkthrough to get hibernate and suspend working on Linux. More a reminder to myself than a walkthrough. Your distro wiki probably has far better instructions for you!</p>
<ol style="list-style-type: decimal">
<li><p>Download and install <a href="http://suspend.sourceforge.net/">uswsusp</a>. It's more than likely that your distro already provides it. (For example, <code>pacman -S uswsusp</code> on arch)</p></li>
<li><p>Download and install <a href="http://pm-utils.freedesktop.org/wiki/">pm-utils</a> once again, check your repos.</p></li>
<li><p>Edit your <code>/etc/suspend.conf</code> file, creating it if neccessary. Add your swap partition to the <code>resume device</code> field. For example, my <code>suspend.conf</code> file looks like this:</p>
<pre><code>snapshot device = /dev/snapshot
resume device = /dev/sda2
#image size = 350000000
#suspend loglevel = 2
#compute checksum = y
compress = y
#encrypt = y
#early writeout = y
#splash = y
shutdown method = shutdown
</code></pre>
<p>Note how i've added a shutdown method and enabled compression.</p></li>
<li><p>Now, recreate the initramfs. To do this, edit the <code>/etc/mkinitcpio.conf</code> file and add <code>uresume</code> in the HOOKS list before the filesystem hook. Then, run</p>
<pre><code>&gt; mkinitcpio -p kernel26
</code></pre></li>
<li><p>Now we need to let pm-utils know that we'll be using uswsusp. To do that create <code>/etc/pm/config.d/module</code> so tha it contains the following:</p>
<pre><code>SLEEP_MODULE=uswsusp
</code></pre></li>
<li><p>All done! Now use <code>pm-suspend</code> to suspend to RAM, <code>pm-hibernate</code> to suspend to disk and <code>pm-suspend-hybrid</code> to suspend to both, which is useful in case of a low battery. If your laptop is anything like mine, you'll have to invoke it as follows:</p>
<pre><code>&gt; sudo pm-hibernate --quirk-dpms-on
</code></pre></li>
</ol>
<p>You can bind that to a key, etc...</p>
<h2 id="extras">Extras</h2>
<p>I want to have my laptop to hibernate whenever the battery gets below a certain level. I like to use <a href="http://acpid.sourceforge.net/">ACPID</a>. Setting up ACPID is really distro-specific, but since I use <a href="http://www.archlinux.org">Arch</a>, I'll go through setting up ACPID on Arch. (This is a reminder to self, after all.)</p>
<ol style="list-style-type: decimal">
<li><p>Install <code>acpi</code>, <code>acpid</code>, add acpid to the DAEMONS in <code>/etc/rc.conf</code></p></li>
<li><p>Define an event catch in <code>/etc/acpi/events/</code> named low_battery_warning that looks like</p>
<pre><code>event=battery.*
action=/etc/acpi/low_battery_warning.sh %e
</code></pre></li>
</ol>
<h3 id="refs">Refs:</h3>
<p><a href="http://www.columbia.edu/~ariel/acpi/acpi_howto.txt">acpi howto</a> <a href="http://mindspill.net/computing/linux-notes/acpi/acpi-low-battery-warning.html">acpi-low-bat</a> <a href="http://wiki.archlinux.org/index.php/Acpid">acpid</a> <a href="http://bbs.archlinux.org/viewtopic.php?id=44080">hibernate on low</a></p>
</body>
</html>
